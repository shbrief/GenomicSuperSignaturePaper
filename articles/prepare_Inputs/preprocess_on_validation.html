<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Preprocessing Inputs for GenomicSuperSignature • GenomicSuperSignaturePaper</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Preprocessing Inputs for GenomicSuperSignature">
<meta property="og:description" content="GenomicSuperSignaturePaper">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">GenomicSuperSignaturePaper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    RAVmodel
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/training_datasets/available_samples.html">Training Data</a>
    </li>
    <li>
      <a href="../../articles/select_numOfClusters/find_optimum_k.html">Number of clusters</a>
    </li>
    <li>
      <a href="../../articles/others/repeat_Fig5_Pathway_Separation.html">Pathway separation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    EDA
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/TCGA/TCGA_5studies.html">Database search</a>
    </li>
    <li>
      <a href="../../articles/E-MTAB-2452/E-MTAB-2452.html">Annoated PCA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Subtyping
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/CRC/PCSS_vs_RAV.html">RAVs similar to PCSS1/2</a>
    </li>
    <li>
      <a href="../../articles/CRC/metadata_based_search.html">Metadata based search</a>
    </li>
    <li>
      <a href="../../articles/CRC/CRC_Subtyping.html">CRC subtype scores</a>
    </li>
    <li>
      <a href="../../articles/CRC/CRC_ClinicalVar.html">CRC clinical variables</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Transfer Learning
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/SLE-WB/neutrophil_counts_SLE-WB.html">Neutrophil (SLE-WB)</a>
    </li>
    <li>
      <a href="../../articles/NARES/neutrophil_counts_NARES.html">Neutrophil (NARES)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/shbrief/GenomicSuperSignaturePaper">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="preprocess_on_validation_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Preprocessing Inputs for GenomicSuperSignature</h1>
                        <h4 class="author">Sehyun Oh</h4>
            
            <h4 class="date">2021-06-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/shbrief/GenomicSuperSignaturePaper/blob/master/vignettes/prepare_Inputs/preprocess_on_validation.Rmd"><code>vignettes/prepare_Inputs/preprocess_on_validation.Rmd</code></a></small>
      <div class="hidden name"><code>preprocess_on_validation.Rmd</code></div>

    </div>

    
    
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<div id="load-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load packages</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/shbrief/GenomicSuperSignature">GenomicSuperSignature</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="ravmodel" class="section level2">
<h2 class="hasAnchor">
<a href="#ravmodel" class="anchor"></a>RAVmodel</h2>
<p>This RAVmodel is built using top 20 PCs of 536 studies. The number of clusters was decided by <code>d=2.25</code> and MSigDB C2 gene sets were used for GSEA-based annotation.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data.dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GenomicSuperSignaturePaper"</span><span class="op">)</span>
<span class="va">RAVmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">data.dir</span>, <span class="st">"RAVmodel_C2.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">RAVmodel</span></code></pre></div>
<pre><code>## class: PCAGenomicSignatures 
## dim: 13934 4764 
## metadata(7): cluster size ... updateNote version
## assays(1): RAVindex
## rownames(13934): CASKIN1 DDX3Y ... CTC-457E21.9 AC007966.1
## rowData names(0):
## colnames(4764): RAV1 RAV2 ... RAV4763 RAV4764
## colData names(4): RAV studies silhouetteWidth gsea
## trainingData(2): PCAsummary MeSH
## trainingData names(536): DRP000987 SRP059172 ... SRP164913 SRP188526</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/GenomicSignatures-methods.html">updateNote</a></span><span class="op">(</span><span class="va">RAVmodel</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "536 refine.bio studies/ top 90% varying genes/ GSEA with MSigDB C2"</code></pre>
</div>
<div id="example-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example data</h2>
<p>We preprocessed gene expression profiles of colon cancer (both microarry and RNA sequencing datasets) in multiple different ways and applied GenomicSuperSignature to see the effect of proprocessing.</p>
<p><strong>Normalization</strong> usually means to scale a variable to have a values between 0 and 1, while <strong>standardization</strong> transforms data to have a mean of zero and a standard deviation of 1.</p>
</div>
</div>
<div id="curatedcrcdata" class="section level1">
<h1 class="hasAnchor">
<a href="#curatedcrcdata" class="anchor"></a>curatedCRCData</h1>
<p>I applied <code>calculateScore</code> directly on these expression matrices and saved the RAV-assigned scores in eSets objects. (described in <code>Results/CRC/R/Fig4_add_sapmleScore.R</code>) These scores were used for subtyping (<code>Results/CRC/repeat_Fig4A.Rmd</code>) and clinical variable analysis (<code>Results/CRC/repeat_Fig4C.Rmd</code>)</p>
<p>But for validation (<code>Results_temp/TCGA/TCGA_5studies.Rmd</code>), I did log-transformation before applying <code>validate</code> function. Also when I search for associated RAVs using metadata, eSets were centered but not transformed before <code>calculateScore</code> applied.</p>
<p><em>–&gt; Need to make these all consistent!!</em></p>
<div id="gse39582_eset" class="section level3">
<h3 class="hasAnchor">
<a href="#gse39582_eset" class="anchor"></a>GSE39582_eset</h3>
<pre><code>## ExpressionSet (storageMode: lockedEnvironment)
## assayData: 19827 features, 566 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: GSM971957 GSM971958 ... GSM972522 (566 total)
##   varLabels: unique_patient_ID alt_sample_name ... RAV4350 (123 total)
##   varMetadata: labelDescription
## featureData
##   featureNames: A1BG A1BG-AS1 ... PCDHGA12 (19827 total)
##   fvarLabels: probeset gene
##   fvarMetadata: labelDescription
## experimentData: use 'experimentData(object)'
##   pubMedIds: 23700391 
## Annotation: hg-u133_plus_2</code></pre>
<pre><code>##          GSM971957 GSM971958 GSM971959 GSM971960
## A1BG      3.633175  4.045605  3.782781  3.890177
## A1BG-AS1  3.885552  4.243311  4.359792  4.064965
## A1CF      6.935159  8.719033  7.705797  8.252904
## A2M       9.812345 10.860767  8.883904 10.072542</code></pre>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-4-1.png" width="384"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="fu">exprs</span><span class="op">(</span><span class="va">GSE39582_eset</span><span class="op">)</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-5-1.png" width="384"></p>
<p>This is used for validation. <img src="preprocess_on_validation_files/figure-html/unnamed-chunk-6-1.png" width="384"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="fu">exprs</span><span class="op">(</span><span class="va">GSE39582_eset</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-7-1.png" width="384"></p>
<p>This was used for metadata-based searching.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exprs_tmp</span> <span class="op">&lt;-</span> <span class="fu">exprs</span><span class="op">(</span><span class="va">GSE39582_eset</span><span class="op">)</span>
<span class="va">exprs_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">exprs_tmp</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">t</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">exprs_tmp</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-8-1.png" width="384"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="va">exprs_tmp</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-9-1.png" width="384"></p>
</div>
<div id="tcga-coad_eset" class="section level3">
<h3 class="hasAnchor">
<a href="#tcga-coad_eset" class="anchor"></a>TCGA.COAD_eset</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_dir</span> <span class="op">&lt;-</span> <span class="st">"~/data2/GenomicSuperSignaturePaper/Results/CRC/data/eSets_new"</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">dat_dir</span>, <span class="st">"TCGA.COAD_eset.RData"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TCGA.COAD_eset</span></code></pre></div>
<pre><code>## ExpressionSet (storageMode: lockedEnvironment)
## assayData: 17814 features, 126 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: TCGA.A6.3810 TCGA.AA.3975 ... TCGA.A6.2686 (126 total)
##   varLabels: unique_patient_ID alt_sample_name ... RAV4350 (123 total)
##   varMetadata: labelDescription
## featureData
##   featureNames: 15E1.2 2'-PDE ... ZZZ3 (17814 total)
##   fvarLabels: probeset gene
##   fvarMetadata: labelDescription
## experimentData: use 'experimentData(object)'
##   pubMedIds: 22810696 
## Annotation: agilent-014850 whole human genome microarray 4x44k g4112f</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">exprs</span><span class="op">(</span><span class="va">TCGA.COAD_eset</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></code></pre></div>
<pre><code>##        TCGA.A6.3810 TCGA.AA.3975 TCGA.AA.3845 TCGA.AA.3979
## 15E1.2   -0.5940000    -0.102250     0.222000    1.4867500
## 2'-PDE   -0.2958750     0.415625     0.215375   -0.0059375
## 7A5       2.9385000     3.116500     3.259000    2.7055000
## A1BG     -0.8536667    -1.787000    -1.743000   -2.1760000</code></pre>
<p>This is used to get score.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu">exprs</span><span class="op">(</span><span class="va">TCGA.COAD_eset</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-11-1.png" width="384"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="fu">exprs</span><span class="op">(</span><span class="va">TCGA.COAD_eset</span><span class="op">)</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-12-1.png" width="384"></p>
<p>This is used for validation.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="fu">exprs</span><span class="op">(</span><span class="va">TCGA.COAD_eset</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in hist(log2(exprs(TCGA.COAD_eset) + 1)): NaNs produced</code></pre>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-13-1.png" width="384"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="fu">exprs</span><span class="op">(</span><span class="va">TCGA.COAD_eset</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, <span class="va">RAVmodel</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in validate(log2(exprs(TCGA.COAD_eset) + 1), RAVmodel): NaNs produced</code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-14-1.png" width="384"></p>
<p>This was used for metadata-based searching.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exprs_tmp</span> <span class="op">&lt;-</span> <span class="fu">exprs</span><span class="op">(</span><span class="va">TCGA.COAD_eset</span><span class="op">)</span>
<span class="va">exprs_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">exprs_tmp</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">t</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">exprs_tmp</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-15-1.png" width="384"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="va">exprs_tmp</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-16-1.png" width="384"></p>
</div>
<div id="tcga-rnaseqv2_eset" class="section level3">
<h3 class="hasAnchor">
<a href="#tcga-rnaseqv2_eset" class="anchor"></a>TCGA.RNASeqV2_eset</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">dat_dir</span>, <span class="st">"TCGA.RNASeqV2_eset.RData"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TCGA.RNASeqV2_eset</span></code></pre></div>
<pre><code>## ExpressionSet (storageMode: lockedEnvironment)
## assayData: 20502 features, 195 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: TCGA.A6.2684 TCGA.A6.2682 ... TCGA.G4.6627 (195 total)
##   varLabels: unique_patient_ID alt_sample_name ... RAV4350 (123 total)
##   varMetadata: labelDescription
## featureData
##   featureNames: ? A1BG ... ZZZ3 (20502 total)
##   fvarLabels: probeset gene
##   fvarMetadata: labelDescription
## experimentData: use 'experimentData(object)'
##   pubMedIds: 22810696 
## Annotation: NA</code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">exprs</span><span class="op">(</span><span class="va">TCGA.RNASeqV2_eset</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></code></pre></div>
<pre><code>##       TCGA.A6.2684 TCGA.A6.2682 TCGA.AA.3495 TCGA.AA.3492
## ?       10.3736442    10.139236     9.873481    10.256330
## A1BG     5.3181397     4.847781     4.338489     5.076773
## A1CF     6.1873204     7.984246     8.193911     7.824986
## A2BP1    0.5496199     0.000000     1.767189     0.000000</code></pre>
<p>This is used to get score.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu">exprs</span><span class="op">(</span><span class="va">TCGA.RNASeqV2_eset</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-18-1.png" width="384"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="fu">exprs</span><span class="op">(</span><span class="va">TCGA.RNASeqV2_eset</span><span class="op">)</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-19-1.png" width="384"></p>
<p>This is used for validation.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="fu">exprs</span><span class="op">(</span><span class="va">TCGA.RNASeqV2_eset</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-20-1.png" width="384"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="fu">exprs</span><span class="op">(</span><span class="va">TCGA.RNASeqV2_eset</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-21-1.png" width="384"></p>
<p>This was used for metadata-based searching.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exprs_tmp</span> <span class="op">&lt;-</span> <span class="fu">exprs</span><span class="op">(</span><span class="va">TCGA.RNASeqV2_eset</span><span class="op">)</span>
<span class="va">exprs_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">exprs_tmp</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">t</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">exprs_tmp</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-22-1.png" width="384"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="va">exprs_tmp</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-23-1.png" width="384"></p>
</div>
</div>
<div id="microarray" class="section level1">
<h1 class="hasAnchor">
<a href="#microarray" class="anchor"></a>Microarray</h1>
<div id="mrnaarray" class="section level2">
<h2 class="hasAnchor">
<a href="#mrnaarray" class="anchor"></a>mRNAArray</h2>
<p>Unified gene-level mRNA expression values</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ma</span> <span class="op">&lt;-</span> <span class="fu">curatedTCGAData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/curatedTCGAData/man/curatedTCGAData.html">curatedTCGAData</a></span><span class="op">(</span><span class="st">"COAD"</span>, <span class="st">"mRNAArray"</span>, dry.run <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">ma</span>, file <span class="op">=</span> <span class="st">"data/ma.rda"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/ma.rda"</span><span class="op">)</span>
<span class="va">ma</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## class: SummarizedExperiment 
## dim: 17814 172 
## metadata(3): filename build platform
## assays(1): ''
## rownames(17814): ELMO2 CREB3L1 ... AQP7 CTSC
## rowData names(0):
## colnames(172): TCGA-A6-2671-11A-01R-1758-07
##   TCGA-A6-2672-01A-01R-0826-07 ... TCGA-AY-4070-01A-01R-1113-07
##   TCGA-AY-4071-01A-01R-1113-07
## colData names(0):</code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">ma</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></code></pre></div>
<pre><code>## DataFrame with 4 rows and 4 columns
##         TCGA-A6-2671-11A-01R-1758-07 TCGA-A6-2672-01A-01R-0826-07
##                            &lt;numeric&gt;                    &lt;numeric&gt;
## ELMO2                      -0.625333                    -0.380083
## CREB3L1                     2.092250                     1.485000
## RPS11                       0.730375                     1.322375
## PNMA1                      -0.219750                    -0.293250
##         TCGA-A6-2674-01A-02R-0821-07 TCGA-A6-2676-11A-01R-1758-07
##                            &lt;numeric&gt;                    &lt;numeric&gt;
## ELMO2                      -0.203750                    -0.921333
## CREB3L1                     2.498750                     1.215500
## RPS11                       0.483125                     1.459250
## PNMA1                      -0.463250                     1.674750</code></pre>
<p>This dataset is identical to <code>TCGA.COAD_eset</code>.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">exprs</span><span class="op">(</span><span class="va">TCGA.COAD_eset</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">ma</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, 
                      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TCGA.A6.2671"</span>, <span class="st">"TCGA.A6.2672"</span>, <span class="st">"TCGA.A6.2674"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>##         TCGA.A6.2671 TCGA.A6.2672 TCGA.A6.2674
## ELMO2     -0.6253333   -0.3800833    -0.203750
## CREB3L1    2.0922500    1.4850000     2.498750
## RPS11      0.7303750    1.3223750     0.483125
## PNMA1     -0.2197500   -0.2932500    -0.463250</code></pre>
</div>
</div>
<div id="rnaseq" class="section level1">
<h1 class="hasAnchor">
<a href="#rnaseq" class="anchor"></a>RNAseq</h1>
<div id="raw-read-count" class="section level2">
<h2 class="hasAnchor">
<a href="#raw-read-count" class="anchor"></a>Raw read count</h2>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">##### Raw read counts from GSE62944 from ExperimentHub #########################</span>
<span class="va">tcga</span> <span class="op">&lt;-</span> <span class="fu">GSEABenchmarkeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GSEABenchmarkeR/man/loadEData.html">loadEData</a></span><span class="op">(</span><span class="st">"tcga"</span>, cache <span class="op">=</span> <span class="cn">FALSE</span>, paired <span class="op">=</span> <span class="cn">FALSE</span>, map2entrez <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">rseq_raw_count</span> <span class="op">&lt;-</span> <span class="va">tcga</span><span class="op">$</span><span class="va">COAD</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">rseq_raw_count</span>, file <span class="op">=</span> <span class="st">"data/rseq_raw_count.rda"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/rseq_raw_count.rda"</span><span class="op">)</span>
<span class="va">rseq_raw_count</span></code></pre></div>
<pre><code>## class: SummarizedExperiment 
## dim: 13210 524 
## metadata(2): dataId dataType
## assays(1): exprs
## rownames(13210): A1CF A2LD1 ... ZZEF1 ZZZ3
## rowData names(0):
## colnames(524): TCGA-DM-A28G-01A-11R-A16W-07
##   TCGA-AA-A004-01A-01R-A00A-07 ... TCGA-A6-2684-11A-01R-A32Z-07
##   TCGA-AA-3518-11A-01R-1672-07
## colData names(3): sample type GROUP</code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_raw_count</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></code></pre></div>
<pre><code>##        TCGA-DM-A28G-01A-11R-A16W-07 TCGA-AA-A004-01A-01R-A00A-07
## A1CF                           1501                           76
## A2LD1                           390                           68
## A2M                            7637                         1439
## A4GALT                          122                          242
##        TCGA-CK-4950-01A-01R-1723-07 TCGA-D5-5539-01A-01R-1653-07
## A1CF                           2048                         1995
## A2LD1                           518                          512
## A2M                           22745                        19599
## A4GALT                          462                          462</code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_raw_count</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-29-1.png" width="384"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_raw_count</span><span class="op">)</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-30-1.png" width="384"></p>
</div>
<div id="log-transformed" class="section level2">
<h2 class="hasAnchor">
<a href="#log-transformed" class="anchor"></a>Log-transformed</h2>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rseq_log</span> <span class="op">&lt;-</span> <span class="va">rseq_raw_count</span>
<span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_log</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_log</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_log</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></code></pre></div>
<pre><code>##        TCGA-DM-A28G-01A-11R-A16W-07 TCGA-AA-A004-01A-01R-A00A-07
## A1CF                      10.552669                     6.266787
## A2LD1                      8.611025                     6.108524
## A2M                       12.898979                    10.491853
## A4GALT                     6.942515                     7.924813
##        TCGA-CK-4950-01A-01R-1723-07 TCGA-D5-5539-01A-01R-1653-07
## A1CF                      11.000704                    10.962896
## A2LD1                      9.019591                     9.002815
## A2M                       14.473325                    14.258566
## A4GALT                     8.854868                     8.854868</code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_log</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-31-1.png" width="384"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_log</span><span class="op">)</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-32-1.png" width="384"></p>
</div>
<div id="tpm" class="section level2">
<h2 class="hasAnchor">
<a href="#tpm" class="anchor"></a>TPM</h2>
<div id="rnaseq2genenorm" class="section level3">
<h3 class="hasAnchor">
<a href="#rnaseq2genenorm" class="anchor"></a>RNASeq2GeneNorm</h3>
<p>Upper quartile normalized RSEM TPM gene expression values</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rseq_geneNorm</span> <span class="op">&lt;-</span> <span class="fu">curatedTCGAData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/curatedTCGAData/man/curatedTCGAData.html">curatedTCGAData</a></span><span class="op">(</span><span class="st">"COAD"</span>, <span class="st">"RNASeq2GeneNorm"</span>, dry.run <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">rseq_geneNorm</span>, file <span class="op">=</span> <span class="st">"data/rseq_geneNorm.rda"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/rseq_geneNorm.rda"</span><span class="op">)</span>
<span class="va">rseq_geneNorm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## class: SummarizedExperiment 
## dim: 20501 191 
## metadata(0):
## assays(1): ''
## rownames(20501): A1BG A1CF ... psiTPTE22 tAKR
## rowData names(0):
## colnames(191): TCGA-A6-2671-01A-01R-1410-07
##   TCGA-A6-2672-01A-01R-0826-07 ... TCGA-CM-4752-01A-01R-1410-07
##   TCGA-CM-5341-01A-01R-1410-07
## colData names(0):</code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_geneNorm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></code></pre></div>
<pre><code>##       TCGA-A6-2671-01A-01R-1410-07 TCGA-A6-2672-01A-01R-0826-07
## A1BG                       25.4180                      60.7006
## A1CF                       10.8359                      15.2866
## A2BP1                       6.1920                       0.0000
## A2LD1                     131.2848                     305.9618
##       TCGA-A6-2674-01A-02R-0821-07 TCGA-A6-2676-01A-01R-0826-07
## A1BG                       54.9872                      32.5974
## A1CF                      122.7621                     107.4380
## A2BP1                       0.0000                     292.7981
## A2LD1                     143.7980                     205.6671</code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_geneNorm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-34-1.png" width="384"></p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_geneNorm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-35-1.png" width="384"></p>
<div id="log-transformation" class="section level4">
<h4 class="hasAnchor">
<a href="#log-transformation" class="anchor"></a>Log transformation</h4>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-36-1.png" width="384"></p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_geneNorm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-37-1.png" width="384"></p>
</div>
<div id="log-transformation-without-low-expressing-genes" class="section level4">
<h4 class="hasAnchor">
<a href="#log-transformation-without-low-expressing-genes" class="anchor"></a>Log transformation without low expressing genes</h4>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-38-1.png" width="384"></p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-39-1.png" width="384"></p>
</div>
</div>
<div id="rnaseqgene" class="section level3">
<h3 class="hasAnchor">
<a href="#rnaseqgene" class="anchor"></a>RNASeqGene</h3>
<p>RSEM TPM gene expression values</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rseq_gene</span> <span class="op">&lt;-</span> <span class="fu">curatedTCGAData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/curatedTCGAData/man/curatedTCGAData.html">curatedTCGAData</a></span><span class="op">(</span><span class="st">"COAD"</span>, <span class="st">"RNASeqGene"</span>, dry.run <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">rseq_gene</span>, file <span class="op">=</span> <span class="st">"data/rseq_gene.rda"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/rseq_gene.rda"</span><span class="op">)</span>
<span class="va">rseq_gene</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>   </code></pre></div>
<pre><code>## class: SummarizedExperiment 
## dim: 20502 10 
## metadata(0):
## assays(1): ''
## rownames(20502): A1BG A1CF ... psiTPTE22 tAKR
## rowData names(0):
## colnames(10): TCGA-AA-3841-01A-01R-0905-07 TCGA-AA-3866-01A-01R-1022-07
##   ... TCGA-AA-3979-01A-01R-1022-07 TCGA-AA-3980-01A-02R-1022-07
## colData names(0):</code></pre>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_gene</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></code></pre></div>
<pre><code>##       TCGA-AA-3841-01A-01R-0905-07 TCGA-AA-3866-01A-01R-1022-07
## A1BG                            28                           48
## A1CF                           112                          211
## A2BP1                            8                            7
## A2LD1                          142                          165
##       TCGA-AA-3870-01A-01R-1022-07 TCGA-AA-3939-01A-01R-1022-07
## A1BG                            54                           77
## A1CF                            51                          176
## A2BP1                           29                            3
## A2LD1                          183                          456</code></pre>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_gene</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-41-1.png" width="384"></p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_gene</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-42-1.png" width="384"></p>
<div id="log-transformation-1" class="section level4">
<h4 class="hasAnchor">
<a href="#log-transformation-1" class="anchor"></a>Log transformation</h4>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-43-1.png" width="384"></p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_gene</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-44-1.png" width="384"></p>
</div>
<div id="log-transformation-without-low-expressing-genes-1" class="section level4">
<h4 class="hasAnchor">
<a href="#log-transformation-without-low-expressing-genes-1" class="anchor"></a>Log transformation without low expressing genes</h4>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Exclude genes with TPM &lt; 2 in more than half of the samples</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">rseq_gene</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">keep</span> <span class="op">&lt;-</span>  <span class="va">rs</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">keep</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-45-1.png" width="384"></p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/validate.html">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, <span class="va">RAVmodel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/heatmapTable.html">heatmapTable</a></span><span class="op">(</span><span class="va">val_all</span><span class="op">)</span></code></pre></div>
<p><img src="preprocess_on_validation_files/figure-html/unnamed-chunk-46-1.png" width="384"></p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">TCGA.COAD_eset</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"\\."</span>, <span class="st">"-"</span>, <span class="va">.</span><span class="op">)</span>
<span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">TCGA.RNASeqV2_eset</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"\\."</span>, <span class="st">"-"</span>, <span class="va">.</span><span class="op">)</span>
<span class="va">s3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">ma</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"TCGA.{8}"</span><span class="op">)</span>
<span class="va">s4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">rseq_raw_count</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"TCGA.{8}"</span><span class="op">)</span>
<span class="va">s5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">rseq_geneNorm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"TCGA.{8}"</span><span class="op">)</span>
<span class="va">s6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">rseq_gene</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"TCGA.{8}"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">common_ma_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html">intersect</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s3</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="conclusions" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusions" class="anchor"></a>Conclusions</h1>
<ol style="list-style-type: decimal">
<li>Data centering is not affecting the validation result. <em>How about score?</em><br>
</li>
<li>Input expression data should have normal distribution (e.g. log-transformed raw RNAseq read count)<br>
</li>
<li>Removing low-expressing genes results in a stronger validation output.</li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sehyun Oh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
