<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compare PCSS and RAVs • GenomicSuperSignaturePaper</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Compare PCSS and RAVs">
<meta property="og:description" content="GenomicSuperSignaturePaper">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">GenomicSuperSignaturePaper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    RAVmodel
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/training_datasets/available_samples.html">Training Data</a>
    </li>
    <li>
      <a href="../../articles/select_numOfClusters/find_optimum_k.html">Number of clusters</a>
    </li>
    <li>
      <a href="../../articles/others/repeat_Fig5_Pathway_Separation.html">Pathway separation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    EDA
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/TCGA/TCGA_5studies.html">Database search</a>
    </li>
    <li>
      <a href="../../articles/E-MTAB-2452/E-MTAB-2452.html">Annoated PCA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Subtyping
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/CRC/CRC_Subtyping.html">CRC subtype scores</a>
    </li>
    <li>
      <a href="../../articles/CRC/PCSS_vs_RAV.html">RAVs similar to PCSS1/2</a>
    </li>
    <li>
      <a href="../../articles/CRC/metadata_based_search.html">Metadata based search</a>
    </li>
    <li>
      <a href="../../articles/CRC/CRC_ClinicalVar.html">CRC clinical variables</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Transfer Learning
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/SLE-WB/neutrophil_counts_SLE-WB.html">Neutrophil (SLE-WB)</a>
    </li>
    <li>
      <a href="../../articles/NARES/neutrophil_counts_NARES.html">Neutrophil (NARES)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/shbrief/GenomicSuperSignaturePaper">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="PCSS_vs_RAV_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Compare PCSS and RAVs</h1>
                        <h4 class="author">Sehyun Oh</h4>
            
            <h4 class="date">2021-07-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/shbrief/GenomicSuperSignaturePaper/blob/master/vignettes/CRC/PCSS_vs_RAV.Rmd"><code>vignettes/CRC/PCSS_vs_RAV.Rmd</code></a></small>
      <div class="hidden name"><code>PCSS_vs_RAV.Rmd</code></div>

    </div>

    
    
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<div id="load-package" class="section level2">
<h2 class="hasAnchor">
<a href="#load-package" class="anchor"></a>Load package</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/shbrief/GenomicSuperSignature">GenomicSuperSignature</a></span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="pcsss" class="section level2">
<h2 class="hasAnchor">
<a href="#pcsss" class="anchor"></a>PCSSs</h2>
<p><a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-018-1511-4">Ma <em>et al.</em></a> proposed a continuous scoring system (PCSS) based on the analysis of eight colorectal cancer microarray datasets comprising 1,867 samples, and found that PCSSs are more closely correlated to microsatellite instability (MSI), grade, stage, and tumor location.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">avgLoading</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/avg_loadings.csv"</span>, 
                         header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span>
<span class="va">avgLoading</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span><span class="va">avgLoading</span>, var<span class="op">=</span><span class="st">"X"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">avgLoading</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"PCSS"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">avgLoading</span><span class="op">)</span>
<span class="co">##              PCSS1        PCSS2        PCSS3         PCSS4</span>
<span class="co">## A1CF  -0.018923764  0.015043200  0.016192833  0.0027314229</span>
<span class="co">## A2M    0.022619204  0.016479342  0.008791011 -0.0007293910</span>
<span class="co">## AAAS  -0.002700998 -0.005051213 -0.001248883  0.0037994266</span>
<span class="co">## AACS  -0.002542282 -0.006858940  0.005834412  0.0058956790</span>
<span class="co">## AADAC -0.003473766 -0.002360232 -0.003660762 -0.0047612188</span>
<span class="co">## AAK1   0.001522205  0.005908014 -0.004708509 -0.0006853461</span></code></pre></div>
</div>
<div id="ravmodel" class="section level2">
<h2 class="hasAnchor">
<a href="#ravmodel" class="anchor"></a>RAVmodel</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">RAVmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/getModel.html">getModel</a></span><span class="op">(</span><span class="st">"C2"</span>, load<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">RAVmodel</span>
<span class="co">## class: PCAGenomicSignatures </span>
<span class="co">## dim: 13934 4764 </span>
<span class="co">## metadata(7): cluster size ... updateNote version</span>
<span class="co">## assays(1): RAVindex</span>
<span class="co">## rownames(13934): CASKIN1 DDX3Y ... CTC-457E21.9 AC007966.1</span>
<span class="co">## rowData names(0):</span>
<span class="co">## colnames(4764): RAV1 RAV2 ... RAV4763 RAV4764</span>
<span class="co">## colData names(4): RAV studies silhouetteWidth gsea</span>
<span class="co">## trainingData(2): PCAsummary MeSH</span>
<span class="co">## trainingData names(536): DRP000987 SRP059172 ... SRP164913 SRP188526</span>

<span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/GenomicSignatures-methods.html">updateNote</a></span><span class="op">(</span><span class="va">RAVmodel</span><span class="op">)</span>
<span class="co">## [1] "536 refine.bio studies/ top 90% varying genes/ GSEA with MSigDB C2"</span></code></pre></div>
</div>
</div>
<div id="ravs-vs--pcsss" class="section level1">
<h1 class="hasAnchor">
<a href="#ravs-vs--pcsss" class="anchor"></a>RAVs vs. PCSSs</h1>
<div id="most-similar-to-pcss12" class="section level2">
<h2 class="hasAnchor">
<a href="#most-similar-to-pcss12" class="anchor"></a>Most similar to PCSS1/2</h2>
<p>We identified RAV1575 and RAV834 as the most similar RAVs to PCSS1 and PCSS2, respectively, based on Pearson correlation coefficient.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">avgLoading</span><span class="op">)</span>, <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">RAVmodel</span><span class="op">)</span><span class="op">)</span>
<span class="va">loading_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">avgLoading</span><span class="op">[</span><span class="va">cg</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/pkg/GenomicSuperSignature/man/GenomicSignatures-methods.html">RAVindex</a></span><span class="op">(</span><span class="va">RAVmodel</span><span class="op">)</span><span class="op">[</span><span class="va">cg</span>,<span class="op">]</span>, 
                              use<span class="op">=</span><span class="st">"pairwise.complete.obs"</span>, method<span class="op">=</span><span class="st">"pearson"</span><span class="op">)</span><span class="op">)</span>

<span class="va">max1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/which.min.html">which.max</a></span><span class="op">(</span><span class="va">loading_cor</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span>  <span class="co"># max. correlation with PCSS1</span>
<span class="va">max2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/which.min.html">which.max</a></span><span class="op">(</span><span class="va">loading_cor</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span>  <span class="co"># max. correlation with PCSS2</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">loading_cor</span><span class="op">[</span><span class="fl">1</span>, <span class="va">max1</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>
<span class="co">##         RAV1575</span>
<span class="co">## PCSS1 0.5894306</span>
<span class="va">loading_cor</span><span class="op">[</span><span class="fl">2</span>, <span class="va">max2</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>
<span class="co">##          RAV834</span>
<span class="co">## PCSS2 0.5624299</span></code></pre></div>
</div>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<details><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">## R version 4.1.0 (2021-05-18)</span>
<span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">## Running under: Ubuntu 18.04.5 LTS</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas/libblas.so.3</span>
<span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/libopenblasp-r0.2.20.so</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span>
<span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">## [1] parallel  stats4    stats     graphics  grDevices utils     datasets </span>
<span class="co">## [8] methods   base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">##  [1] GenomicSuperSignature_1.1.4 SummarizedExperiment_1.22.0</span>
<span class="co">##  [3] Biobase_2.52.0              GenomicRanges_1.44.0       </span>
<span class="co">##  [5] GenomeInfoDb_1.28.1         IRanges_2.26.0             </span>
<span class="co">##  [7] S4Vectors_0.30.0            BiocGenerics_0.38.0        </span>
<span class="co">##  [9] MatrixGenerics_1.4.0        matrixStats_0.59.0         </span>
<span class="co">## [11] BiocStyle_2.20.2           </span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##   [1] colorspace_2.0-2       ggsignif_0.6.2         rjson_0.2.20          </span>
<span class="co">##   [4] ellipsis_0.3.2         rio_0.5.27             rprojroot_2.0.2       </span>
<span class="co">##   [7] circlize_0.4.13        XVector_0.32.0         GlobalOptions_0.1.2   </span>
<span class="co">##  [10] fs_1.5.0               clue_0.3-59            ggpubr_0.4.0          </span>
<span class="co">##  [13] bit64_4.0.5            fansi_0.5.0            codetools_0.2-18      </span>
<span class="co">##  [16] doParallel_1.0.16      cachem_1.0.5           knitr_1.33            </span>
<span class="co">##  [19] jsonlite_1.7.2         Cairo_1.5-12.2         broom_0.7.8           </span>
<span class="co">##  [22] cluster_2.1.2          dbplyr_2.1.1           png_0.1-7             </span>
<span class="co">##  [25] BiocManager_1.30.16    compiler_4.1.0         httr_1.4.2            </span>
<span class="co">##  [28] backports_1.2.1        assertthat_0.2.1       Matrix_1.3-4          </span>
<span class="co">##  [31] fastmap_1.1.0          htmltools_0.5.1.1      tools_4.1.0           </span>
<span class="co">##  [34] gtable_0.3.0           glue_1.4.2             GenomeInfoDbData_1.2.6</span>
<span class="co">##  [37] dplyr_1.0.7            rappdirs_0.3.3         Rcpp_1.0.7            </span>
<span class="co">##  [40] carData_3.0-4          cellranger_1.1.0       jquerylib_0.1.4       </span>
<span class="co">##  [43] pkgdown_1.6.1          vctrs_0.3.8            iterators_1.0.13      </span>
<span class="co">##  [46] xfun_0.24              stringr_1.4.0          openxlsx_4.2.4        </span>
<span class="co">##  [49] lifecycle_1.0.0        rstatix_0.7.0          zlibbioc_1.38.0       </span>
<span class="co">##  [52] scales_1.1.1           ragg_1.1.3             hms_1.1.0             </span>
<span class="co">##  [55] RColorBrewer_1.1-2     ComplexHeatmap_2.8.0   yaml_2.2.1            </span>
<span class="co">##  [58] curl_4.3.2             memoise_2.0.0          ggplot2_3.3.5         </span>
<span class="co">##  [61] sass_0.4.0             stringi_1.6.2          RSQLite_2.2.7         </span>
<span class="co">##  [64] desc_1.3.0             foreach_1.5.1          filelock_1.0.2        </span>
<span class="co">##  [67] zip_2.2.0              shape_1.4.6            rlang_0.4.11          </span>
<span class="co">##  [70] pkgconfig_2.0.3        systemfonts_1.0.2      bitops_1.0-7          </span>
<span class="co">##  [73] evaluate_0.14          lattice_0.20-44        purrr_0.3.4           </span>
<span class="co">##  [76] bit_4.0.4              tidyselect_1.1.1       magrittr_2.0.1        </span>
<span class="co">##  [79] bookdown_0.22          R6_2.5.0               generics_0.1.0        </span>
<span class="co">##  [82] DelayedArray_0.18.0    DBI_1.1.1              pillar_1.6.1          </span>
<span class="co">##  [85] haven_2.4.1            foreign_0.8-81         abind_1.4-5           </span>
<span class="co">##  [88] RCurl_1.98-1.3         tibble_3.1.2           crayon_1.4.1          </span>
<span class="co">##  [91] car_3.0-11             utf8_1.2.1             BiocFileCache_2.0.0   </span>
<span class="co">##  [94] rmarkdown_2.9          GetoptLong_1.0.5       grid_4.1.0            </span>
<span class="co">##  [97] readxl_1.3.1           data.table_1.14.0      blob_1.2.1            </span>
<span class="co">## [100] forcats_0.5.1          digest_0.6.27          tidyr_1.1.3           </span>
<span class="co">## [103] textshaping_0.3.5      munsell_0.5.0          bslib_0.2.5.1</span></code></pre></div>
</details>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sehyun Oh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
